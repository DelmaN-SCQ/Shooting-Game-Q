<!DOCTYPE html>
<html lang="pl">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>SGQ Beta</title>
<style>
body {margin:0; background:#0b0b0f; font-family:sans-serif; color:white; text-align:center;}
#gameWrap {position:relative; width:760px; height:540px; margin:auto; background:#050607;}
canvas {display:block;}
#hpbar {position:absolute; bottom:10px; left:50%; transform:translateX(-50%); width:70%; height:14px; background:rgba(255,255,255,0.1); border-radius:7px;}
#hpFill {height:100%; width:100%; background:linear-gradient(90deg,#40ff9d,#00b37a);}
#menu {position:absolute; inset:0; display:flex; align-items:center; justify-content:center; flex-direction:column; background:rgba(0,0,0,0.6); backdrop-filter:blur(3px);}
button {padding:8px 12px; border:none; border-radius:8px; background:#0b1320; color:#eaf6f0; cursor:pointer; font-weight:600;}
#status {width:760px; margin:auto; display:flex; justify-content:space-between; padding:8px 0;}
</style>
</head>
<body>
<div id="gameWrap">
  <canvas id="gameCanvas" width="760" height="540"></canvas>
  <div id="hpbar"><div id="hpFill"></div></div>
  <div id="menu">
    <h1>SGQ Beta</h1>
    <button onclick="startGame()">Graj</button>
    <p style="font-size:13px; color:#99a0ac;">Ruch: WASD lub strzałki, Strzał: Spacja</p>
  </div>
</div>
<div id="status">
  <div>Punkty: <span id="score">0</span></div>
  <div>Fala: <span id="wave">0</span></div>
  <div>HP: <span id="hpText">100</span></div>
</div>

<script>
const canvas = document.getElementById('gameCanvas');
const ctx = canvas.getContext('2d');

let running = false;
let score = 0, wave = 0;
let playerHP = 100, maxHP = 100;

const keys = {};
let player, bullets=[], enemies=[];

window.addEventListener('keydown', e => { keys[e.code] = true; if(e.code==='Space') e.preventDefault(); });
window.addEventListener('keyup', e => { keys[e.code] = false; });

function rand(min,max){ return Math.random()*(max-min)+min; }

function spawnPlayer(){ 
  player = {x:canvas.width/2-20, y:canvas.height-60, w:40, h:40, speed:4, fireCooldown:0};
  playerHP = maxHP; updateUI();
}

function spawnWave(n){
  wave++;
  document.getElementById('wave').textContent = wave;
  for(let i=0;i<n;i++){
    enemies.push({x:rand(20,canvas.width-60), y:rand(-200,-40)-i*60, w:40, h:40, speed:1+rand(0,0.5)});
  }
}

function playerShoot(){
  if(player.fireCooldown>0) return;
  bullets.push({x:player.x+player.w/2-4, y:player.y-10, w:8, h:14, color:'#ffe18b'});
  player.fireCooldown = 12;
}

function updateUI(){
  document.getElementById('score').textContent = score;
  document.getElementById('hpText').textContent = playerHP;
  const pct = Math.max(0, playerHP/maxHP*100);
  document.getElementById('hpFill').style.width = pct + '%';
}

function update(){
  // ruch gracza
  if(keys['KeyW']||keys['ArrowUp']) player.y-=player.speed;
  if(keys['KeyS']||keys['ArrowDown']) player.y+=player.speed;
  if(keys['KeyA']||keys['ArrowLeft']) player.x-=player.speed;
  if(keys['KeyD']||keys['ArrowRight']) player.x+=player.speed;
  player.x = Math.max(0, Math.min(canvas.width-player.w, player.x));
  player.y = Math.max(0, Math.min(canvas.height-player.h, player.y));
  
  if(keys['Space']) playerShoot();
  if(player.fireCooldown>0) player.fireCooldown--;

  // pociski
  bullets.forEach((b,i)=>{ b.y-=8; if(b.y<-20) bullets.splice(i,1); });

  // przeciwnicy
  enemies.forEach((e,i)=>{
    e.y+=e.speed;
    // kolizja pocisków
    bullets.forEach((b,j)=>{
      if(b.x < e.x + e.w && b.x + b.w > e.x && b.y < e.y + e.h && b.y + b.h > e.y){
        enemies.splice(i,1); bullets.splice(j,1); score+=10;
      }
    });
    if(e.y>canvas.height) enemies.splice(i,1);
  });

  if(enemies.length===0) spawnWave(4);
  updateUI();
}

function draw(){
  ctx.clearRect(0,0,canvas.width,canvas.height);
  // gracz
  ctx.fillStyle='#00e0a8'; ctx.fillRect(player.x,player.y,player.w,player.h);
  // pociski
  bullets.forEach(b=>{ ctx.fillStyle=b.color; ctx.fillRect(b.x,b.y,b.w,b.h); });
  // przeciwnicy
  enemies.forEach(e=>{ ctx.fillStyle='#ff5c5c'; ctx.fillRect(e.x,e.y,e.w,e.h); });
}

function loop(){ if(!running) return; update(); draw(); requestAnimationFrame(loop); }

function startGame(){
  document.getElementById('menu').style.display='none';
  running = true; score=0; wave=0; playerHP=maxHP; bullets=[]; enemies=[];
  spawnPlayer(); spawnWave(4); updateUI(); loop();
}
</script>
</body>
</html>
