<!DOCTYPE html>
<html lang="pl">
<head>
<meta charset="UTF-8">
<title>Space Shooter Futuristic</title>
<style>
    body { margin:0; background:#000; overflow:hidden; font-family:Arial; color:white; }
    #ui { position:absolute; top:20px; left:20px; font-size:20px; z-index:10; }
    #menu, #gameover {
        position:absolute; inset:0; display:flex; flex-direction:column;
        align-items:center; justify-content:center;
        background:rgba(0,0,0,0.6); z-index:20; color:white;
    }
    button { padding:14px 28px; margin:10px; font-size:22px; border:none; border-radius:10px; cursor:pointer; }
</style>
</head>
<body>

<div id="ui">
    Score: <span id="score">0</span><br>
    Highscore: <span id="hs">0</span>
</div>

<canvas id="game"></canvas>

<div id="menu">
    <h1>SPACE SHOOTER</h1>
    <button onclick="startGame()">Zagraj</button>
</div>

<div id="gameover" style="display:none;">
    <h1>Koniec gry!</h1>
    <p>Wynik: <span id="finalScore">0</span></p>
    <button onclick="location.reload()">Zagraj ponownie</button>
</div>

<script>
// === CANVAS ===
const canvas = document.getElementById("game");
const ctx = canvas.getContext("2d");
canvas.width = innerWidth;
canvas.height = innerHeight;

// === PLAYER ===
const player = {
    x: canvas.width / 2,
    y: canvas.height - 150,
    speed: 7,
    width: 40,
    height: 40,
    lives: 100
};

let bullets = [];
let enemies = [];
let gameStarted = false;
let gameOver = false;

let score = 0;
let highScore = Number(localStorage.getItem("neo_high") || 0);
document.getElementById("hs").innerText = highScore;

// === FIRE ===
function fire() {
    bullets.push({
        x: player.x - 3,
        y: player.y - 30,
        w: 6,
        h: 16,
        speed: 12
    });
}

// === ENEMY ===
function spawnEnemy() {
    enemies.push({
        x: Math.random() * (canvas.width - 40),
        y: -60,
        w: 40,
        h: 40,
        hp: 40,
        flash: 0
    });
}
setInterval(spawnEnemy, 1000);

// === START ===
function startGame() {
    document.getElementById("menu").style.display = "none";
    gameStarted = true;
}

// === UPDATE ===
function update() {
    if (!gameStarted || gameOver) return;

    // movement
    if (keys["ArrowLeft"]) player.x -= player.speed;
    if (keys["ArrowRight"]) player.x += player.speed;
    if (keys["ArrowUp"]) player.y -= player.speed;
    if (keys["ArrowDown"]) player.y += player.speed;

    // clamp
    player.x = Math.max(20, Math.min(canvas.width - 20, player.x));
    player.y = Math.max(20, Math.min(canvas.height - 20, player.y));

    // bullets
    for (let i = bullets.length - 1; i >= 0; i--) {
        bullets[i].y -= bullets[i].speed;
        if (bullets[i].y < -20) bullets.splice(i, 1);
    }

    // enemies
    for (let i = enemies.length - 1; i >= 0; i--) {
        let e = enemies[i];
        e.y += 3;

        // collision with bullets
        for (let j = bullets.length - 1; j >= 0; j--) {
            let b = bullets[j];
            if (b.x < e.x + e.w && b.x + b.w > e.x &&
                b.y < e.y + e.h && b.y + b.h > e.y) {

                bullets.splice(j, 1);
                e.hp -= 20;
                e.flash = 4;

                if (e.hp <= 0) {
                    score += 100;

                    if (score > highScore) {
                        highScore = score;
                        localStorage.setItem("neo_high", highScore);
                    }

                    enemies.splice(i, 1);
                }
            }
        }

        // collision with player
        if (player.x - 20 < e.x + e.w &&
            player.x + 20 > e.x &&
            player.y - 20 < e.y + e.h &&
            player.y + 20 > e.y) {
            
            player.lives -= 20;
            enemies.splice(i, 1);

            if (player.lives <= 0) {
                document.getElementById("finalScore").innerText = score;
                document.getElementById("gameover").style.display = "flex";
                gameOver = true;
            }
        }

        // remove offscreen
        if (e.y > canvas.height + 100) enemies.splice(i, 1);
    }
}

// === DRAW ===
function draw() {
    ctx.clearRect(0, 0, canvas.width, canvas.height);

    // background
    let g = ctx.createLinearGradient(0, 0, 0, canvas.height);
    g.addColorStop(0, "#06101b");
    g.addColorStop(1, "#000000");
    ctx.fillStyle = g;
    ctx.fillRect(0, 0, canvas.width, canvas.height);

    // UI
    document.getElementById("score").innerText = score;
    document.getElementById("hs").innerText = highScore;

    // === PLAYER (ULEPSZONA NEONOWA RAKIETA) ===
    ctx.save();
    ctx.translate(player.x, player.y);
    const p = 2;

    const rocket = [
"0000001221000000",
"0000011222210000",
"0000112222221000",
"0001122dd2221100",
"00112ddddddd2110",
"0012dddd77ddd210",
"0122d7777777d221",
"0122d7777777d221",
"0122d7777777d221",
"0012d7777777d210",
"0012777777777210",
"0002777777777200",
"0002777777777200",
"0002777777777200",
"0002777777777200",
"0002777777777200",
"0002dd777777d200",
"0002dd777777d200",
"0002dd777777d200",
"00002d77777d2000",
"00002d77777d2000",
"000002fffff20000",
"00002ffffffff200",
"0002ffffffffff20",
"00002ffffffff200"
    ];

    const col = {
        "1": "#00ffc3",   // neon outline
        "2": "#00d8ff",   // main hull
        "d": "#0084ff",   // shading
        "7": "#00b3ff",   // wings
        "f": "#ffea00"    // thruster flame
    };

    ctx.imageSmoothingEnabled = false;

    for (let y = 0; y < rocket.length; y++) {
        for (let x = 0; x < rocket[y].length; x++) {
            const px = rocket[y][x];
            if (px !== "0") {
                ctx.fillStyle = col[px];
                ctx.fillRect((x - 7) * p, (y - 15) * p, p, p);
            }
        }
    }

    ctx.restore();

    // bullets
    ctx.fillStyle = "#fff071";
    bullets.forEach(b => ctx.fillRect(b.x, b.y, b.w, b.h));

    // enemies
    enemies.forEach(e => {
        ctx.fillStyle = e.flash > 0 ? "#ffffff" : "#ff3838";
        if (e.flash > 0) e.flash--;
        ctx.fillRect(e.x, e.y, e.w, e.h);
    });
}

// === GAME LOOP ===
setInterval(() => {
    update();
    draw();
}, 16);

// === INPUT ===
const keys = {};
onkeydown = e => { keys[e.key] = true; if (e.key === " ") fire(); };
onkeyup = e => keys[e.key] = false;

</script>
</body>
</html>
