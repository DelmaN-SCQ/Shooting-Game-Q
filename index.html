<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Shooting Game Q BetaTest</title>

<style>
body {
    background: #111;
    display: flex;
    justify-content: center;
    align-items: center;
    height: 100vh;
    margin: 0;
    color: white;
    font-family: Arial;
}
canvas {
    border: 3px solid #fff;
    background: black;
}

/* MENU STARTOWE */
#menu {
    position: absolute;
    top: 0; left: 0;
    width: 100%;
    height: 100%;
    background: rgba(0,0,0,0.85);
    display: flex;
    flex-direction: column;
    justify-content: center;
    align-items: center;
    gap: 20px;
}

button {
    padding: 10px 25px;
    font-size: 20px;
    border: none;
    border-radius: 6px;
    cursor: pointer;
}
button:hover {
    background: #333;
    color: white;
}

/* HUD */
#hud {
    position: absolute;
    top: 10px;
    width: 100%;
    text-align: center;
    font-size: 18px;
    display: flex;
    justify-content: space-between;
    padding: 0 20px;
}
</style>
</head>

<body>

<div id="menu">
    <h1>Strzelanka 2D</h1>
    <p>Wybierz poziom trudności:</p>
    <button onclick="startGame(1)">Łatwy</button>
    <button onclick="startGame(2)">Średni</button>
    <button onclick="startGame(3)">Trudny</button>
</div>

<div id="hud">
    <div id="score">Punkty: 0</div>
    <div id="lives">Życia: 3</div>
</div>

<canvas id="gameCanvas" width="600" height="400"></canvas>

<script>
const canvas = document.getElementById("gameCanvas");
const ctx = canvas.getContext("2d");

let difficulty = 1;
let score = 0;
let lives = 3;

let player;
let bullets = [];
let enemies = [];
let enemySpawnTimer = 0;

let left = false;
let right = false;

document.addEventListener("keydown", e => {
    if (e.key === "ArrowLeft") left = true;
    if (e.key === "ArrowRight") right = true;
});
document.addEventListener("keyup", e => {
    if (e.key === "ArrowLeft") left = false;
    if (e.key === "ArrowRight") right = false;
});
document.addEventListener("click", shoot);

let shootSound = new Audio("https://actions.google.com/sounds/v1/alarms/beep_short.ogg");
let hitSound   = new Audio("https://actions.google.com/sounds/v1/cartoon/pop.ogg");

function startGame(diff) {
    difficulty = diff;
    score = 0;
    lives = 3;
    document.getElementById("score").textContent = "Punkty: 0";
    document.getElementById("lives").textContent = "Życia: 3";

    bullets = [];
    enemies = [];

    player = {
        x: 280,
        y: 360,
        width: 40,
        height: 20,
        speed: 5
    };

    document.getElementById("menu").style.display = "none";

    gameLoop();
}

function shoot() {
    bullets.push({
        x: player.x + player.width/2 - 2,
        y: player.y,
        width: 4,
        height: 10,
        speed: 7
    });

    shootSound.play();
}

function spawnEnemy() {
    enemies.push({
        x: Math.random() * 560,
        y: -20,
        width: 40,
        height: 20,
        speed: 1 + difficulty * 1.5
    });
}

function update() {
    if (left && player.x > 0) player.x -= player.speed;
    if (right && player.x < canvas.width - player.width) player.x += player.speed;

    bullets.forEach((b, i) => {
        b.y -= b.speed;
        if (b.y < 0) bullets.splice(i, 1);
    });

    enemies.forEach((e, i) => {
        e.y += e.speed;

        if (e.y > canvas.height) {
            enemies.splice(i, 1);
            lives--;
            document.getElementById("lives").textContent = "Życia: " + lives;

            if (lives <= 0) {
                alert("Koniec gry! Twój wynik: " + score);
                location.reload();
            }
        }

        bullets.forEach((b, j) => {
            if (
                b.x < e.x + e.width &&
                b.x + b.width > e.x &&
                b.y < e.y + e.height &&
                b.y + b.height > e.y
            ) {
                enemies.splice(i, 1);
                bullets.splice(j, 1);

                score++;
                document.getElementById("score").textContent = "Punkty: " + score;

                hitSound.play();
            }
        });
    });

    enemySpawnTimer++;
    if (enemySpawnTimer > 60 - difficulty * 10) {
        spawnEnemy();
        enemySpawnTimer = 0;
    }
}

function draw() {
    ctx.clearRect(0, 0, canvas.width, canvas.height);

    ctx.fillStyle = "lime";
    ctx.fillRect(player.x, player.y, player.width, player.height);

    ctx.fillStyle = "yellow";
    bullets.forEach(b => ctx.fillRect(b.x, b.y, b.width, b.height));

    ctx.fillStyle = "red";
    enemies.forEach(e => {
        // mała animacja pulsowania wrogów
        ctx.save();
        ctx.globalAlpha = 0.8 + Math.sin(Date.now()/200) * 0.2;
        ctx.fillRect(e.x, e.y, e.width, e.height);
        ctx.restore();
    });
}

function gameLoop() {
    update();
    draw();
    requestAnimationFrame(gameLoop);
}
</script>

</body>
</html>
