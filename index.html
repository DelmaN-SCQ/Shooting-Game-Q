<!DOCTYPE html>
<html lang="pl">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Futuristic Shooter</title>
<style>
body, html{margin:0;padding:0;height:100%;overflow:hidden;background:#071025;font-family:sans-serif;color:#e6f7ff;}
canvas{display:block;}
#hud{position:fixed;left:20px;bottom:20px;width:200px;}
.bar-bg{background:rgba(255,255,255,0.15);height:12px;width:100%;border-radius:6px;margin-bottom:6px;}
.bar-fill{height:12px;width:50%;border-radius:6px;}
#scoreboard{position:fixed;right:20px;top:20px;text-align:right;}
#scoreboard div{margin-bottom:6px;}
#menu, #gameover{position:fixed;top:0;left:0;right:0;bottom:0;background:rgba(0,0,0,0.75);display:flex;justify-content:center;align-items:center;flex-direction:column;z-index:10;}
button{padding:10px 20px;margin:6px;font-size:16px;cursor:pointer;border-radius:10px;border:none;background:#1de9b6;color:#021019;font-weight:700;}
</style>
</head>
<body>
<canvas id="game"></canvas>

<div id="hud">
  <div>HP</div>
  <div class="bar-bg"><div id="hp" class="bar-fill" style="background:red;"></div></div>
  <div>XP</div>
  <div class="bar-bg"><div id="xp" class="bar-fill" style="background:lime;"></div></div>
</div>

<div id="scoreboard">
  <div>Poziom: <span id="level">1</span></div>
  <div>Punkty: <span id="score">0</span></div>
  <div>Najlepszy: <span id="highscore">0</span></div>
</div>

<div id="menu">
  <h1>Futuristic Shooter</h1>
  <button id="startBtn">Zagraj</button>
</div>

<div id="gameover" style="display:none">
  <h1>Koniec gry</h1>
  <div>Twój wynik: <span id="finalScore">0</span></div>
  <button id="restartBtn">Nowa gra</button>
  <button id="menuBtn">Menu</button>
</div>

<script>
// --- Canvas setup ---
const canvas = document.getElementById('game');
const ctx = canvas.getContext('2d');
canvas.width = window.innerWidth;
canvas.height = window.innerHeight;
window.addEventListener('resize',()=>{canvas.width=window.innerWidth;canvas.height=window.innerHeight;});

// --- Game variables ---
let player = {x:canvas.width/2, y:canvas.height-100, w:48, h:48, speed:7, hp:100, maxHp:100};
let bullets = [];
let enemies = [];
let score = 0;
let level = parseInt(localStorage.getItem('level')) || 1;
let xp = parseInt(localStorage.getItem('xp')) || 0;
let xpGoal = 100;
let highscore = parseInt(localStorage.getItem('highscore')) || 0;
let gameStarted = false;
let gameOver = false;

// --- Sprites ---
const playerImg = new Image();
playerImg.src = 'https://i.imgur.com/8f0E4tG.png'; // przykładowy rakieta sprite PNG
const enemyImg = new Image();
enemyImg.src = 'https://i.imgur.com/4W9xZ0s.png'; // przykładowy wrog sprite PNG
const bulletImg = new Image();
bulletImg.src = 'https://i.imgur.com/8cVUpok.png'; // przykładowy pocisk

// --- HUD ---
const hpBar = document.getElementById('hp');
const xpBar = document.getElementById('xp');
const levelSpan = document.getElementById('level');
const scoreSpan = document.getElementById('score');
const highscoreSpan = document.getElementById('highscore');

// --- Menu buttons ---
document.getElementById('startBtn').onclick = startGame;
document.getElementById('restartBtn').onclick = startGame;
document.getElementById('menuBtn').onclick = ()=>{
    document.getElementById('menu').style.display='flex';
    document.getElementById('gameover').style.display='none';
    gameOver=false;
};

// --- Input ---
const keys = {};
window.addEventListener('keydown',e=>keys[e.key]=true);
window.addEventListener('keyup',e=>keys[e.key]=false);

// --- Game functions ---
function startGame(){
    document.getElementById('menu').style.display='none';
    document.getElementById('gameover').style.display='none';
    player.x=canvas.width/2; player.y=canvas.height-100; player.hp=100;
    bullets=[]; enemies=[]; score=0; xp=0;
    gameStarted = true; gameOver=false;
    updateHUD();
    spawnEnemies();
}

function spawnEnemies(){
    enemies = [];
    for(let i=0;i<5;i++){
        enemies.push({x:Math.random()*(canvas.width-48), y:-Math.random()*400, w:48, h:48, hp:40});
    }
}

function fire(){
    bullets.push({x:player.x+player.w/2-6, y:player.y-16, w:12, h:16, speed:15});
}

function update(){
    if(!gameStarted || gameOver) return;

    // Player movement
    if(keys['ArrowLeft']||keys['a']) player.x-=player.speed;
    if(keys['ArrowRight']||keys['d']) player.x+=player.speed;
    player.x=Math.max(0, Math.min(canvas.width-player.w, player.x));

    // Shooting
    if(keys[' ']) fire();

    // Bullets update
    for(let i=bullets.length-1;i>=0;i--){
        bullets[i].y -= bullets[i].speed;
        if(bullets[i].y<-bullets[i].h){ bullets.splice(i,1); continue; }
        for(let j=enemies.length-1;j>=0;j--){
            let e=enemies[j];
            if(bullets[i].x+bullets[i].w>e.x && bullets[i].x<e.x+e.w && bullets[i].y<e.y+e.h && bullets[i].y+bullets[i].h>e.y){
                e.hp -= 20;
                bullets.splice(i,1);
                if(e.hp<=0){
                    enemies.splice(j,1);
                    score += 10;
                    xp += 20;
                    if(xp>=xpGoal){ level++; xp-=xpGoal; xpGoal=Math.floor(xpGoal*1.3);}
                    spawnEnemies();
                }
                break;
            }
        }
    }

    // Enemies update
    for(let i=enemies.length-1;i>=0;i--){
        enemies[i].y += 2;
        if(enemies[i].y>canvas.height){
            player.hp -= 20;
            enemies.splice(i,1);
            spawnEnemies();
            if(player.hp<=0) endGame();
        }
    }

    updateHUD();
}

function updateHUD(){
    hpBar.style.width = (player.hp/player.maxHp*100)+'%';
    xpBar.style.width = (xp/xpGoal*100)+'%';
    levelSpan.textContent = level;
    scoreSpan.textContent = score;
    highscoreSpan.textContent = highscore;
}

function endGame(){
    gameOver=true;
    gameStarted=false;
    document.getElementById('gameover').style.display='flex';
    document.getElementById('finalScore').textContent = score;
    if(score>highscore) highscore=score;
    localStorage.setItem('highscore',highscore);
    localStorage.setItem('level',level);
    localStorage.setItem('xp',xp);
}

function draw(){
    ctx.clearRect(0,0,canvas.width,canvas.height);
    // player
    ctx.drawImage(playerImg, player.x, player.y, player.w, player.h);
    // bullets
    bullets.forEach(b=>ctx.drawImage(bulletImg, b.x, b.y, b.w, b.h));
    // enemies
    enemies.forEach(e=>{
        ctx.drawImage(enemyImg, e.x, e.y, e.w, e.h);
        // hp bar
        ctx.fillStyle='red';
        ctx.fillRect(e.x, e.y-6, e.w, 4);
        ctx.fillStyle='lime';
        ctx.fillRect(e.x, e.y-6, e.w*(e.hp/40),4);
    });
}

// --- Game loop ---
function loop(){
    update();
    draw();
    requestAnimationFrame(loop);
}
loop();

// Show highscore/level before start
updateHUD();
</script>
</body>
</html>
