<!DOCTYPE html>
<html lang="pl">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Futuristic Shooter â€” Pro</title>
<style>
  :root{
    --bg1:#071025; --bg2:#000814; --accent:#1de9b6; --accent2:#66fcf1;
    --muted:#9aa5b1;
  }
  html,body{height:100%;margin:0;background:linear-gradient(180deg,var(--bg1),var(--bg2));font-family:Inter,Arial,Helvetica,sans-serif;color:#e6f7ff;}
  canvas{display:block;width:100vw;height:100vh;}
  /* HUD cluster top-right */
  #hudCluster{position:fixed;right:18px;top:18px;display:flex;flex-direction:column;gap:8px;align-items:flex-end;pointer-events:auto}
  .hudBox{background:rgba(10,18,30,0.45);padding:8px 12px;border-radius:10px;border:1px solid rgba(160,255,230,0.06);backdrop-filter:blur(6px);min-width:170px}
  .hudTitle{font-size:13px;color:var(--muted);margin:0}
  .hudValue{font-size:18px;color:#eafff7;margin:0;font-weight:600}
</style>
</head>
<body>

<canvas id="gameCanvas"></canvas>

<!-- HUD top-right -->
<div id="hudCluster" aria-hidden="true">
  <div class="hudBox"><p class="hudTitle">Punkty</p><p id="hudScore" class="hudValue">0</p></div>
  <div class="hudBox"><p class="hudTitle">Poziom</p><p id="hudLevel" class="hudValue">1</p></div>
  <div class="hudBox"><p class="hudTitle">High Score</p><p id="hudHS" class="hudValue">0</p></div>
</div>

<script>
/* -------------------------
   Setup canvas
------------------------- */
const canvas = document.getElementById('gameCanvas');
const ctx = canvas.getContext('2d');
function resize(){ canvas.width=window.innerWidth; canvas.height=window.innerHeight; }
window.addEventListener('resize',resize,{passive:true});
resize();

/* -------------------------
   Game state
------------------------- */
let level = parseInt(localStorage.getItem('fs_level')) || 1;
let xp = parseInt(localStorage.getItem('fs_xp')) || 0;
let xpGoal = parseInt(localStorage.getItem('fs_xpGoal')) || 100;
let highScore = parseInt(localStorage.getItem('fs_high')) || 0;

let gameStarted=false, gameOver=false, paused=false;
let score=0, kills=0;
const maxEnemies=10, maxPowerUps=2;
let spawnRate=1200, enemyHP=40;

/* -------------------------
   Sprites (in-code PNG)
------------------------- */
function makeSprite_drawPixelArt(w,h,drawFn){
  const c=document.createElement('canvas'); c.width=w; c.height=h;
  const g=c.getContext('2d'); g.imageSmoothingEnabled=false;
  drawFn(g,w,h);
  const img=new Image();
  img.src=c.toDataURL(); return img;
}
const spriteSize=32;

const playerImg = makeSprite_drawPixelArt(spriteSize,spriteSize,(g,w,h)=>{
  g.clearRect(0,0,w,h);
  g.fillStyle='#00d1a1'; g.fillRect(12,4,8,18);
  g.fillStyle='#003f2f'; g.fillRect(12,4,8,4);
  g.fillStyle='#00b388'; g.fillRect(8,18,4,6); g.fillRect(20,18,4,6);
  g.fillStyle='#ff8a00'; g.fillRect(14,22,4,6);
});

const bulletImg = makeSprite_drawPixelArt(8,16,(g,w,h)=>{
  g.clearRect(0,0,w,h);
  g.fillStyle='#ffec5c'; g.fillRect(2,0,4,12);
  g.fillStyle='#ffaa00'; g.fillRect(3,12,2,4);
});

const enemyImg = makeSprite_drawPixelArt(spriteSize,spriteSize,(g,w,h)=>{
  g.clearRect(0,0,w,h);
  g.fillStyle='#ff6b6b'; g.fillRect(6,6,20,20);
  g.fillStyle='#7f1d1d'; g.fillRect(6,6,20,6);
  g.fillStyle='#ffa3a3'; g.fillRect(10,12,12,12);
});

/* -------------------------
   Player, bullets, enemies
------------------------- */
const player = { x:canvas.width/2, y:canvas.height-110, width:48, height:64, speed:7, lives:100, maxLives:100, shield:false };
const bullets=[]; const enemies=[]; const powerUps=[];

/* -------------------------
   Utility
------------------------- */
function clamp(v,a,b){ return Math.max(a,Math.min(b,v)); }

/* -------------------------
   Spawn enemies & powerups
------------------------- */
function spawnEnemy(){
  if(enemies.length>=maxEnemies) return;
  const size=36+Math.floor(Math.random()*26);
  const x=Math.random()*(canvas.width-size);
  const color=['#ff6b6b','#ffb86b','#b86bff','#6bd9ff'][Math.floor(Math.random()*4)];
  enemies.push({x,y:-size,width:size,height:size,hp:enemyHP,maxHp:enemyHP,color,flash:0});
}
function spawnPowerup(){
  if(powerUps.length>=maxPowerUps) return;
  const size=20;
  const x=Math.random()*(canvas.width-size);
  const type=Math.random()<0.5?'life':'shield';
  powerUps.push({x,y:-size,size,type,pulse:Math.random()*Math.PI*2});
}

/* -------------------------
   Player actions
------------------------- */
function fire(){ bullets.push({x:player.x-8,y:player.y-28,w:12,h:28,speed:18}); }

function startGame(){
  gameStarted=true; gameOver=false; paused=false;
  player.x=canvas.width/2; player.y=canvas.height-110; player.lives=100; player.shield=false;
  bullets.length=0; enemies.length=0; powerUps.length=0;
}

/* -------------------------
   Update loop
------------------------- */
function update(dt){
  if(!gameStarted||gameOver||paused) return;
  if(keys['ArrowLeft']||keys['a']) player.x-=player.speed;
  if(keys['ArrowRight']||keys['d']) player.x+=player.speed;
  if(keys['ArrowUp']||keys['w']) player.y-=player.speed;
  if(keys['ArrowDown']||keys['s']) player.y+=player.speed;
  player.x=clamp(player.x,player.width/2,canvas.width-player.width/2);
  player.y=clamp(player.y,player.height/2,canvas.height-player.height/2);

  // bullets
  for(let i=bullets.length-1;i>=0;i--){
    const b=bullets[i]; b.y-=b.speed;
    if(b.y+b.h<0) bullets.splice(i,1);
  }

  // enemies
  for(let i=enemies.length-1;i>=0;i--){
    const e=enemies[i]; e.y+=1.2+(enemyHP/60)*0.8;
    for(let j=bullets.length-1;j>=0;j--){
      const b=bullets[j];
      if(b.x<e.x+e.width&&b.x+b.w>e.x&&b.y<e.y+e.height&&b.y+b.h>e.y){
        bullets.splice(j,1); e.hp-=20; e.flash=6;
        if(e.hp<=0){ score+=100; xp+=20; if(xp>=xpGoal){ level++; xp-=xpGoal; xpGoal=Math.floor(xpGoal*1.5); } enemies.splice(i,1); }
        break;
      }
    }
    if(!player.shield && player.x-player.width/2<e.x+e.width && player.x+player.width/2>e.x && player.y-player.height/2<e.y+e.height && player.y+player.height/2>e.y){
      enemies.splice(i,1); player.lives-=20;
      if(player.lives<=0){ gameOver=true; gameStarted=false; if(score>highScore){ highScore=score; localStorage.setItem('fs_high',highScore); } }
    }
    if(e.y>canvas.height+100) enemies.splice(i,1);
  }

  // powerups
  for(let i=powerUps.length-1;i>=0;i--){
    const p=powerUps[i]; p.y+=1.2; p.pulse+=0.06;
    if(player.x-player.width/2<p.x+p.size && player.x+player.width/2>p.x && player.y-player.height/2<p.y+p.size && player.y+player.height/2>p.y){
      if(p.type==='life'){ player.lives=Math.min(player.maxLives,player.lives+20); }
      else{ player.shield=true; shieldTimer=600; }
      powerUps.splice(i,1);
    }
    if(p.y>canvas.height+40) powerUps.splice(i,1);
  }

  localStorage.setItem('fs_level',level);
  localStorage.setItem('fs_xp',xp);
  localStorage.setItem('fs_xpGoal',xpGoal);
  localStorage.setItem('fs_high',highScore);
}

/* -------------------------
   Drawing
------------------------- */
function draw(){
  ctx.clearRect(0,0,canvas.width,canvas.height);

  // background gradient
  const g=ctx.createLinearGradient(0,0,0,canvas.height);
  g.addColorStop(0,'#071025'); g.addColorStop(1,'#000814');
  ctx.fillStyle=g; ctx.fillRect(0,0,canvas.width,canvas.height);

  // draw player
  const pw=player.width, ph=player.height;
  if(playerImg.complete) ctx.drawImage(playerImg,player.x-pw/2,player.y-ph/2,pw,ph);
  else{ ctx.fillStyle='#1de9b6'; ctx.fillRect(player.x-pw/2,player.y-ph/2,pw,ph); }

  // bullets
  for(const b of bullets){ if(bulletImg.complete) ctx.drawImage(bulletImg,b.x,b.y,b.w,b.h); else{ ctx.fillStyle='#ffec5c'; ctx.fillRect(b.x,b.y,b.w,b.h); } }

  // enemies
  for(const e of enemies){
    if(enemyImg.complete) ctx.drawImage(enemyImg,e.x,e.y,e.width,e.height);
    else{ ctx.fillStyle=e.color; ctx.fillRect(e.x,e.y,e.width,e.height); }
    // hp bar
    const barW=e.width;
    ctx.fillStyle='#222'; ctx.fillRect(e.x,e.y-8,barW,6);
    ctx.fillStyle='#6eff9f'; ctx.fillRect(e.x,e.y-8,barW*(e.hp/e.maxHp),6);
    ctx.strokeStyle='rgba(0,0,0,0.4)'; ctx.strokeRect(e.x,e.y-8,barW,6);
  }

  // powerups
  for(const p of powerUps){
    const pulse=1+Math.sin(p.pulse)*0.12;
    ctx.save(); ctx.translate(p.x+p.size/2,p.y+p.size/2); ctx.globalAlpha=0.95;
    if(p.type==='life'){ ctx.fillStyle='#4cff6b'; ctx.beginPath(); ctx.arc(0,0,p.size/2*pulse,0,Math.PI*2); ctx.fill(); }
    else{ ctx.fillStyle='#6bd9ff'; ctx.beginPath(); ctx.arc(0,0,p.size/2*pulse,0,Math.PI*2); ctx.fill(); }
    ctx.restore();
  }

  // bottom bars HP & XP
  const barW=Math.min(420,canvas.width*0.44);
  const hpX=20, hpY=canvas.height-80;
  ctx.fillStyle='#1b1f25'; ctx.fillRect(hpX,hpY,barW,28);
  ctx.fillStyle='#ff5f57'; ctx.fillRect(hpX,hpY,barW*(player.lives/player.maxLives),28);
  ctx.strokeStyle='rgba(255,255,255,0.08)'; ctx.strokeRect(hpX,hpY,barW,28);
  ctx.fillStyle='#e6f7ff'; ctx.font='14px Arial'; ctx.textAlign='left';
  ctx.fillText(`HP ${player.lives}/${player.maxLives}`, hpX+10,hpY+18);

  const xpY=hpY+36;
  ctx.fillStyle='#1b1f25'; ctx.fillRect(hpX,xpY,barW,16);
  ctx.fillStyle='#7da8ff'; ctx.fillRect(hpX,xpY,barW*(xp/xpGoal),16);
  ctx.strokeStyle='rgba(255,255,255,0.06)'; ctx.strokeRect(hpX,xpY,barW,16);
  ctx.fillStyle='#cfe7ff'; ctx.font='12px Arial';
  ctx.fillText(`XP ${xp} / ${xpGoal}`, hpX+10,xpY+12);
}

/* -------------------------
   Input
------------------------- */
const keys={};
addEventListener('keydown',e=>{ if(e.key===' ') fire(); keys[e.key]=true; });
addEventListener('keyup',e=>{ keys[e.key]=false; });

/* -------------------------
   Game loop
------------------------- */
let last=performance.now();
function frame(now){ const dt=now-last; last=now; update(dt); draw(); requestAnimationFrame(frame); }
requestAnimationFrame(frame);

/* -------------------------
   Spawning intervals
------------------------- */
setInterval(()=>{ if(gameStarted) spawnEnemy(); }, spawnRate);
setInterval(()=>{ if(gameStarted) spawnPowerup(); },15000);
</script>
</body>
</html>
