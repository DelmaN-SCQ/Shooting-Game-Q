<!DOCTYPE html>
<html lang="pl">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1.0">
<title>Shooting Game Q Beta</title>
<style>
  html,body{margin:0;height:100%;background:#000;font-family:Arial;overflow:hidden;}
  canvas{display:block;margin:0 auto;background:#06060b;}
  #hud{position:absolute;top:10px;left:10px;color:#0ff;font-size:18px;}
  #menu{position:absolute;top:0;left:0;width:100%;height:100%;
        display:flex;justify-content:center;align-items:center;background:rgba(0,0,0,0.85);
        color:#0ff;font-size:28px;flex-direction:column;}
  button{font-size:20px;padding:10px 20px;margin-top:15px;cursor:pointer;background:#111;color:#0ff;border:2px solid #0ff;border-radius:6px;}
</style>
</head>
<body>

<div id="menu">
  <div>Neon 2D Strzelanka</div>
  <button id="startBtn">START</button>
</div>

<div id="hud">
  Lives: <span id="lives">3</span> | HP: <span id="hp">100</span> | Score: <span id="score">0</span>
</div>

<canvas id="game" width="640" height="800"></canvas>

<script>
const canvas = document.getElementById('game');
const ctx = canvas.getContext('2d');
const W = canvas.width, H = canvas.height;

// Menu
const menu = document.getElementById('menu');
document.getElementById('startBtn').onclick = ()=>{menu.style.display='none'; startGame();};

// HUD
let score=0, lives=3;
const elLives=document.getElementById('lives');
const elHP=document.getElementById('hp');
const elScore=document.getElementById('score');

// Player
const player = {x:W/2,y:H-60,w:40,h:40,speed:5,hp:100,maxHp:100,lastShot:0,fireRate:240,rapidUntil:0};

// Input
const keys={};
window.addEventListener('keydown', e=>keys[e.key]=true);
window.addEventListener('keyup', e=>keys[e.key]=false);

// Entities
let bullets=[], enemies=[], pickups=[], particles=[];

// Sounds
const audioCtx = new (window.AudioContext||window.webkitAudioContext)();
function playSound(freq=700){
  const o = audioCtx.createOscillator();
  const g = audioCtx.createGain();
  o.type="sine"; o.frequency.value=freq; g.gain.value=0.15;
  o.connect(g); g.connect(audioCtx.destination);
  o.start(); o.stop(audioCtx.currentTime+0.15);
}

// Stars
const stars = Array.from({length:120},()=>({x:Math.random()*W,y:Math.random()*H,s:Math.random()*2}));

// Functions
function spawnBullet(x,y,dx=0,dy=-8){ bullets.push({x,y,dx,dy,w:8,h:16}); }
function spawnEnemy(){
  const t = Math.random();
  let e = {x:Math.random()*(W-50),y:-50,w:50,h:50,hp:1,type:0,t:0};
  if(t<0.6) { e.type=0; e.hp=1; }
  else if(t<0.85) { e.type=1; e.hp=2; }
  else { e.type=2; e.hp=3; }
  enemies.push(e);
}
function spawnPickup(x,y){ pickups.push({x,y,w:20,h:20,vy:2}); }
function spawnExplosion(x,y,count=12){
  for(let i=0;i<count;i++){
    particles.push({x,y,r:Math.random()*4+2,vx:(Math.random()-0.5)*4,vy:(Math.random()-0.5)*4,life:12});
  }
}
function coll(a,b){return a.x<a.x+b.w && a.x+a.w>b.x && a.y<b.y+b.h && a.y+a.h>b.y;}

let last = performance.now();

function update(dt){
  // stars
  stars.forEach(s=>{ s.y+=dt*40; if(s.y>H) s.y=0; });

  // player movement
  if(keys["ArrowLeft"]) player.x -= player.speed;
  if(keys["ArrowRight"]) player.x += player.speed;
  player.x = Math.max(20, Math.min(W-20, player.x));

  // shooting
  const now = performance.now();
  const rate = now<player.rapidUntil?80:player.fireRate;
  if(keys[" "] && now-player.lastShot>rate){ 
    spawnBullet(player.x-10,player.y-20); 
    spawnBullet(player.x+10,player.y-20);
    playSound(900);
    player.lastShot = now;
  }

  // bullets
  bullets.forEach(b=>{ b.x+=b.dx*dt*60; b.y+=b.dy*dt*60; });
  bullets = bullets.filter(b=>b.y>-20);

  // enemies
  if(Math.random()<0.02) spawnEnemy();
  enemies.forEach((e,ei)=>{
    if(e.type==0) e.y+=2*dt*60;
    else if(e.type==1){ e.t+=dt*60; e.y+=1.5*dt*60; e.x+=Math.sin(e.t*0.1)*3; }
    else { e.t+=dt*60; e.y+=1*dt*60; }

    bullets.forEach(bi=>{
      if(coll(bi,e)){
        e.hp--; bi.dead=true; spawnExplosion(bi.x,bi.y,6); score+=10;
        if(e.hp<=0) enemies.splice(ei,1);
      }
    });
  });
  enemies = enemies.filter(e=>e.y<H+60);
  bullets = bullets.filter(b=>!b.dead);

  // pickups
  pickups.forEach((p,i)=>{ p.y+=p.vy; if(coll(p,player)) pickups.splice(i,1); });

  // particles
  particles.forEach(p=>{ p.x+=p.vx; p.y+=p.vy; p.life--; });
  particles = particles.filter(p=>p.life>0);

  // HUD
  elScore.textContent = score;
  elLives.textContent = lives;
  elHP.textContent = Math.floor(player.hp);
}

function draw(){
  ctx.clearRect(0,0,W,H);

  // stars
  ctx.fillStyle="#0ff";
  stars.forEach(s=>ctx.fillRect(s.x,s.y,s.s,s.s));

  // player (triangle)
  ctx.fillStyle="#0ff";
  ctx.beginPath();
  ctx.moveTo(player.x, player.y-20);
  ctx.lineTo(player.x-20, player.y+20);
  ctx.lineTo(player.x+20, player.y+20);
  ctx.closePath();
  ctx.fill();

  // bullets
  ctx.fillStyle="#ff0";
  bullets.forEach(b=>ctx.fillRect(b.x-b.w/2, b.y-b.h/2, b.w, b.h));

  // enemies
  enemies.forEach(e=>{
    ctx.fillStyle=e.type==0?"#f0f":"#f80"; 
    if(e.type==0){
      ctx.beginPath();
      ctx.moveTo(e.x+25,e.y); ctx.lineTo(e.x+50,e.y+50); ctx.lineTo(e.x,e.y+50); ctx.closePath(); ctx.fill();
    } else if(e.type==1){
      ctx.beginPath();
      ctx.moveTo(e.x+25,e.y); ctx.lineTo(e.x+50,e.y+25); ctx.lineTo(e.x+25,e.y+50); ctx.lineTo(e.x,e.y+25); ctx.closePath(); ctx.fill();
    } else {
      ctx.beginPath();
      let size=25; let cx=e.x+25,cy=e.y+25;
      for(let i=0;i<6;i++){
        let angle=Math.PI/3*i; ctx.lineTo(cx+size*Math.cos(angle),cy+size*Math.sin(angle));
      } ctx.closePath(); ctx.fill();
    }
  });

  // pickups
  ctx.fillStyle="#4ff";
  pickups.forEach(p=>ctx.beginPath(),ctx.arc(p.x+10,p.y+10,10,0,2*Math.PI),ctx.fill());

  // particles
  particles.forEach(p=>{
    ctx.fillStyle="rgba(255,255,255,0.7)";
    ctx.beginPath(); ctx.arc(p.x,p.y,p.r,0,2*Math.PI); ctx.fill();
  });
}

function loop(now){
  const dt = (now-last)/1000;
  last=now;
  update(dt);
  draw();
  requestAnimationFrame(loop);
}

function startGame(){ last=performance.now(); loop(last); }

</script>

</body>
</html>
